"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.testCaseSteps = testCaseSteps;
function testCaseSteps(testStep, metadataKey) {
    const stepsExtractor = (context) => {
        const steps = context[metadataKey]?.steps;
        if (!steps || steps.length === 0) {
            return;
        }
        return steps.map((testStepMetadata) => {
            const testStepContext = {
                ...context,
                testStepMetadata,
                result: {},
                value: {
                    ...testStepMetadata,
                },
            };
            testStepContext.result = testStep(testStepContext);
            const promisedProperties = testStep(testStepContext);
            Object.defineProperty(promisedProperties, 'steps', {
                enumerable: true,
                get: () => innerStepsExtractor(testStepContext),
            });
            return promisedProperties;
        });
    };
    const innerStepsExtractor = metadataKey === 'testStepMetadata'
        ? stepsExtractor
        : testCaseSteps(testStep, 'testStepMetadata');
    return stepsExtractor;
}
//# sourceMappingURL=testCaseSteps.js.map