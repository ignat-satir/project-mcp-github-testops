"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.javascript = void 0;
const jest_docblock_1 = require("jest-docblock");
const common_1 = require("../common");
const errors_1 = require("../../errors");
const extractDocblockAbove_1 = require("./extractDocblockAbove");
const javascript = ({ $, value = {} }) => {
    const options = value;
    const extractDocblockFromLine = options.docblockPosition === 'inside' ? notImplemented : extractDocblockAbove_1.extractDocblockAbove;
    return {
        name: 'javascript',
        extractDocblock: ({ fileName, lineNumber }) => {
            if (fileName && (0, common_1.detectJS)(fileName)) {
                return $.getFileNavigator(fileName).then((navigator) => {
                    if (!navigator)
                        return;
                    let docblock = lineNumber
                        ? extractDocblockFromLine(navigator, lineNumber)
                        : (0, jest_docblock_1.extract)(navigator.getContent());
                    docblock = docblock.trim();
                    return docblock ? (0, jest_docblock_1.parseWithComments)(docblock) : undefined;
                });
            }
            return;
        },
    };
};
exports.javascript = javascript;
function notImplemented() {
    throw new errors_1.AllureRuntimeError('Extracting docblock inside JavaScript source code is not implemented yet');
}
//# sourceMappingURL=index.js.map